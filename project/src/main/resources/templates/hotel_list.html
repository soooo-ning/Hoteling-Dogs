<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="|${pageName}|"></title>
	<!-- CSS 파일 링크 -->
	<link rel="stylesheet" th:href="@{/css/scroll.css}">
	<link rel="stylesheet" th:href="@{/css/hotel_list.css}">
	<link rel="stylesheet" th:href="@{/css/nav_보현.css}">
	<!-- Bootstrap CSS CDN -->
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	<!-- Bootstrap Icons CDN -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
	<!-- Bootstrap Date Range Picker CSS -->
	<link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
<div class="header">
<!-- 네비게이션 바 -->
<div th:insert="~{nav :: nav}"></div>

<!-- 네비게이션 바의 높이만큼 여백을 주어 콘텐츠가 네비게이션 바 아래에 위치하도록 함 -->
	<div style="height: 60px;"></div> 
</div>

<!-- body -->
<!-- Main Content -->
<div class="content">
	<div class="filter">
	    <select id="filterDropdown" onchange="applyFilter()">
	        <option value="category">기본순</option>
	        <option value="wishCount" th:selected="${filter == 'wishCount'}">찜 많은 순</option>
	        <option value="price_asc" th:selected="${filter == 'price_asc'}">가격 낮은 순</option>
	        <option value="price_desc" th:selected="${filter == 'price_desc'}">가격 높은 순</option>
	    </select>
	</div>
    <div class="countlist">
    <h2 th:if="${keyword == null or keyword.isEmpty()}">
        전체 호텔 리스트 
        <span th:text="${totalHotelsCount} + '개'"></span>
    </h2>
    <h2 th:unless="${keyword == null or keyword.isEmpty()}">
        <span th:text="| '${keyword}' 검색 결과 |"></span>
        <span th:text="${totalHotelsCount} + '개'"></span>
    </h2>
	</div>
    <ul class="hotel-list">
    <li th:each="hotel : ${hotelList}" class="hotel-item">
        <input type="hidden" id="uId" th:value="${uId}"/>
		<a th:href="@{/hotel/{hotelId}(hotelId=${hotel.hotelId})}">
		        <img th:src="@{/images/{imageName}(imageName=${hotel.getMainImage() != null ? hotel.getMainImage().getImageUrl() : 'default.jpg'})}" alt="Hotel Image">
		    
        <div class="hotel-details">
            <div class="hotel-name" th:text="${hotel?.hotelName}">Hotel Name</div>
            <ul>
				
                <!-- 호텔에 대한 사용 가능한 모든 방 가격을 나열 -->
                <li th:each="room : ${availableRooms.get(hotel.getHotelId())}" class="room-item">
                    <div>
                        <div class="room-prices">
                            <div>
                                <span th:text="${room.isRoomAvailableForDateRange(startDate, endDate) ? room.getFormattedPrice() : 'No rooms available'}">Price</span>
                            </div>
                        </div>
                    </div>
                </li>
                <!-- 방이 없을 경우 메시지 표시 -->
                <li th:if="${availableRooms.get(hotel.getHotelId()) == null || availableRooms.get(hotel.getHotelId()).isEmpty()}" class="room-item">
                    <div>
                        <div class="room-prices">
                            <div>
                                <span>No rooms available</span>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
			</a>
            <div class="hotel-info" th:text="${hotel?.content}">Detailed info about the hotel.</div>
			<button class="heart-button" th:data-hotel-id="${hotel?.hotelId}" th:classappend="${wishlist != null and wishlist.contains(hotel.hotelId) ? 'heart-filled' : ''}" onclick="toggleWishlist(this)">
		        <i class="fa fa-heart"></i>
		    </button>
			
        </div>
    </li>
</ul>

</div>

<div class="pagination">
    <ul>
        <!-- 처음으로 버튼 -->
        <li th:if="${currentPage > 0}">
            <a href="javascript:void(0);" th:onclick="'redirectToSearch(0)'">처음으로</a>
        </li>

        <!-- 이전 버튼 -->
        <li th:if="${currentPage > 0}">
            <a href="javascript:void(0);" th:onclick="'redirectToSearch(' + ${currentPage - 1} + ')'">
                <i class="bi bi-chevron-double-left"></i>
            </a>
        </li>

        <!-- 페이지 번호 목록 -->
        <li th:each="i : ${#numbers.sequence(startPage, endPage)}">
            <a th:classappend="${currentPage == i} ? 'active'"
               href="javascript:void(0);" th:onclick="'redirectToSearch(' + ${i} + ')'" 
               th:text="${i + 1}">1</a>
        </li>

        <!-- 다음 버튼 -->
        <li th:if="${currentPage < totalPages - 1}">
            <a href="javascript:void(0);" th:onclick="'redirectToSearch(' + ${currentPage + 1} + ')'">
                <i class="bi bi-chevron-double-right"></i>
            </a>
        </li>
    </ul>
</div>

<!-- 스크롤 업-->
<div>
	<i class="bi bi-arrow-up-square-fill" id="scrollUpIcon"></i>
</div>
<div th:replace="~{footer :: footer}"></div>
	<!-- jQuery (필수) -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<!-- Bootstrap JS and dependencies -->
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<!-- Moment.js (필수) -->
	<script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js"></script>
	<!-- Bootstrap Date Range Picker JS -->
	<script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
	<!-- 스크립트 -->
	<script th:src="@{/js/hotellist_nav.js}" type="text/javascript"></script>
	<script th:src="@{/js/scroll.js}" type="text/javascript"></script>
	<script th:src="@{/js/hotel_list.js}" type="text/javascript"></script>
</body>
</html>