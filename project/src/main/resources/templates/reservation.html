<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="_csrf" th:content="${_csrf.token}" />
    <meta name="_csrf_header" th:content="${_csrf.headerName}" />
    <title>예약 내용 확인 및 결제</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" th:href="@{/css/nav_보현.css}" />
    <link rel="stylesheet" th:href="@{/css/reservation.css}" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-1.2.0.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <script th:src="@{/js/page_nav.js}" type="text/javascript"></script>
    <script th:src="@{/js/reservation.js}"></script>
  </head>

  <body style="font-family: 'Pretendard-Regular'">
    <div class="bootstrap-scope">
      <div class="header">
        <div th:insert="~{nav :: nav}"></div>
        <div style="height: 60px"></div>
      </div>
    </div>
    <div class="custom-scope">
      <div class="reservation-item">
        <div class="main-box">
          <h1>예약 내용 확인 및 결제</h1>

          <div class="column">
            <div class="left-column">
              <div class="hotel-info">
                <h2>호텔 정보</h2>
                <div class="hotel-card">
                  <img
                    th:src="${hotelMainImageUrl}"
                    th:alt="${hotel.hotelName + ' 이미지'}"
                    th:if="${hotelMainImageUrl != null}"
                  />
                  <div class="hotel-details">
                    <div class="hotel-id" th:text="'호텔 번호 ' + ${hotel.hotelId}">호텔 번호 44292</div>
                    <div id="hotel-name" class="hotel-name" th:text="${hotel.hotelName}">대형 강아지 운동장 디어독</div>
                    <div th:text="'강아지 유형 : ' + ${dogType}">강아지 유형 : 소형견</div>
                  </div>
                </div>

                <div class="date-info">
                  <div class="check-in">
                    <h3>체크인</h3>
                    <div th:text="${#temporals.format(startDate, 'yyyy.MM.dd (E)')}">2024.08.07 (수)</div>
                    <div>15:00</div>
                  </div>
                  <div class="check-out">
                    <h3>체크아웃</h3>
                    <div th:text="${#temporals.format(endDate, 'yyyy.MM.dd (E)')}">2024.08.07 (수)</div>
                    <div>11:00</div>
                  </div>
                </div>
              </div>

              <hr />

              <form th:object="${reservationForm}" method="post" th:action="@{/reservation}">
                <input type="hidden" th:name="hotelId" th:value="${hotel.hotelId}" />
                <input type="hidden" th:name="startDate" th:value="${startDate}" />
                <input type="hidden" th:name="endDate" th:value="${endDate}" />
                <input type="hidden" th:name="originalDogType" th:value="${param.dogType}" />
                <input type="hidden" id="paymentMethod" name="paymentMethod" />
                <input type="hidden" id="impUid" name="impUid" />

                <div class="reservation-info">
                  <h2>예약자 정보</h2>
                  <div class="form-group">
                    <label for="name" class="required-field">이름</label>
                    <input
                      type="text"
                      th:field="*{reservationName}"
                      id="name"
                      class="input-field"
                      required
                      placeholder="예약자 성함을 입력해 주세요"
                      autocomplete="name"
                    />
                    <div id="name-error" class="error-message"></div>
                  </div>

                  <div class="form-group">
                    <label for="tell-number" class="required-field">연락처</label>
                    <input
                      type="tel"
                      th:field="*{reservationTel}"
                      id="tell-number"
                      class="input-field"
                      required
                      placeholder="'-' 없이 숫자만 입력해 주세요"
                      autocomplete="tel"
                    />
                    <div id="tell-number-error" class="error-message"></div>
                  </div>
                </div>

                <hr />

                <div class="dog-info">
                  <h2>강아지 정보</h2>
                  <div class="form-group">
                    <label for="dog-name" class="required-field">이름</label>
                    <input
                      type="text"
                      th:field="*{dogName}"
                      id="dog-name"
                      class="input-field"
                      required
                      placeholder="반려견 이름을 입력해 주세요"
                      autocomplete="off"
                    />
                    <div id="dog-name-error" class="error-message"></div>
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label class="required-field">성별</label>
                      <div class="content-options">
                        <button type="button" class="content-button" th:field="*{dogGender}" value="MALE">남아</button>
                        <button type="button" class="content-button" th:field="*{dogGender}" value="FEMALE">
                          여아
                        </button>
                        <button type="button" class="content-button" th:field="*{dogGender}" value="NEUTERED">
                          중성화
                        </button>
                      </div>
                      <div id="gender-error" class="error-message"></div>
                    </div>

                    <div class="form-group">
                      <label for="age" class="required-field">나이</label>
                      <select th:field="*{dogAge}" id="age" class="input-field" required autocomplete="off">
                        <option value="">나이를 선택하세요</option>
                        <option
                          th:each="i : ${#numbers.sequence(0, 20)}"
                          th:value="${i}"
                          th:text="${i + '살'}"
                        ></option>
                      </select>
                      <div id="age-error" class="error-message"></div>
                    </div>
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label for="weight" class="required-field">무게</label>
                      <input
                        type="number"
                        th:field="*{dogWeight}"
                        id="weight"
                        class="input-field"
                        step="0.1"
                        required
                        placeholder="kg 단위로 입력해 주세요"
                        autocomplete="off"
                      />
                      <div id="weight-error" class="error-message"></div>
                    </div>

                    <div class="form-group">
                      <label for="breed" class="required-field">종</label>
                      <input
                        type="text"
                        th:field="*{dogBreed}"
                        id="breed"
                        class="input-field"
                        required
                        placeholder="견종을 입력해 주세요"
                        autocomplete="off"
                      />
                      <div id="breed-error" class="error-message"></div>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="special-requests">특이사항</label>
                    <textarea
                      th:field="*{specialRequests}"
                      id="special-requests"
                      class="input-field"
                      placeholder="반려견의 특이사항이 있다면 입력해 주세요"
                      autocomplete="off"
                    ></textarea>
                  </div>
                </div>

                <hr />

                <div class="payment-info">
                  <h2>결제 금액</h2>
                  <div class="price-details">
                    <div class="price-row">
                      <span th:text="'총 ' + ${nights} + '박'">총 1박</span>
                      <span th:text="${#numbers.formatDecimal(totalPrice, 0, 'COMMA', 0, 'POINT') + '원'}"
                        >50,000원</span
                      >
                    </div>
                    <div class="price-row coupon">
                      <span>쿠폰 사용 (-)</span>
                      <span>0원</span>
                    </div>
                    <div class="price-row point">
                      <span>포인트 사용 (-)</span>
                      <span>0원</span>
                    </div>
                    <div class="price-row total">
                      <span>최종 결제 금액</span>
                      <span th:text="${#numbers.formatDecimal(totalPrice, 0, 'COMMA', 0, 'POINT') + '원'}"
                        >50,000원</span
                      >
                    </div>
                  </div>
                  <div
                    class="point-earn"
                    th:text="${#numbers.formatDecimal(totalPrice * 0.01, 0, 'COMMA', 0, 'POINT') + ' P 가 적립됩니다'}"
                  >
                    500 P 가 적립됩니다
                  </div>
                </div>
              </form>
            </div>

            <div class="right-column">
              <div class="payment-summary">
                <h2>결제 수단</h2>
                <div class="payment-options">
                  <button type="button" class="payment-button">카카오페이</button>
                  <button type="button" class="payment-button">토스페이</button>
                </div>
                <div id="payment-method-error" class="error-message"></div>

                <div class="agreement">
                  <div class="agree-all">
                    <input type="checkbox" id="agree-all" />
                    <label for="agree-all">전체 동의하기</label>
                  </div>
                  <div class="agree-item">
                    <input type="checkbox" id="agree-personal" />
                    <label for="agree-personal"
                      >이용규칙/취소/환불규정/개인정보 제3자 제공 동의 <span class="required">(필수)</span></label
                    >
                  </div>
                  <div id="agree-personal-error" class="error-message"></div>
                  <div class="agree-item">
                    <input type="checkbox" id="agree-confirm" />
                    <label for="agree-confirm"
                      >입력한 정보와 실제 예약정보가 같음을 확인합니다. <span class="required">(필수)</span></label
                    >
                  </div>
                  <div id="agree-confirm-error" class="error-message"></div>
                </div>

                <button
                  id="paymentButton"
                  type="submit"
                  class="payment-button submit"
                  th:text="${#numbers.formatDecimal(totalPrice, 0, 'COMMA', 0, 'POINT') + '원 결제하기'}"
                >
                  50,000원 결제하기
                </button>
                <p class="payment-notice">결제하면 예약이 확정됩니다</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
