# Hoteling-Dogs

ê°•ì•„ì§€ í˜¸í…” ì˜ˆì•½ í”Œë«í¼ íŒ€í”„ë¡œì íŠ¸ ì†ŒìŠ¤ì½”ë“œ ë°±ì—…ì…ë‹ˆë‹¤. <br>
ì‹¤ì œ ë°°í¬ìš© X

<br>

## ğŸ—“ï¸ Project Period
2024.08 - 2024.09 (5ì£¼)

<br>

## ğŸ”§ Tech Stack

<img src="https://img.shields.io/badge/java-FF7800?style=flat-square&logo=java&logoColor=white"/> &nbsp;
<img src="https://img.shields.io/badge/javascript-F7DF1E?style=flat-square&logo=javascript&logoColor=white"/> &nbsp;
<img src="https://img.shields.io/badge/springboot-6DB33F?style=flat-square&logo=springboot&logoColor=white"/> &nbsp;
<img src="https://img.shields.io/badge/thymeleaf-005F0F?style=flat-square&logo=thymeleaf&logoColor=white"/> &nbsp;
<img src="https://img.shields.io/badge/mysql-4479A1?style=flat-square&logo=mysql&logoColor=white"/> &nbsp;
<br>

> **Backend**: Spring Boot, JPA, Gradle <br>
> **Frontend**: Thymeleaf <br>
> **Authentication**: Spring Security, JWT, OAuth 2.0 (Google, Kakao) <br>
> **Database**: MySQL, Redis <br>
> **External API**: Iamport (Payment), Gmail SMTP <br>
> **Deployment**: AWS EC2 <br>

<br>

## ğŸ“ƒ Output



<br>

## ğŸ‘¨â€ğŸ’» My Role

<table border="1" cellspacing="0" cellpadding="8">
  <thead>
    <tr>
      <th>êµ¬ë¶„</th>
      <th>ê¸°ëŠ¥</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="6">í˜¸í…” ìƒì„¸ í˜ì´ì§€</td>
      <td>í˜¸í…” ì •ë³´ ì¡°íšŒ (ì´ë¯¸ì§€, ì§€ë„ ìœ„ì¹˜, ë¦¬ë·°, Q&amp;A)</td>
    </tr>
    <tr>
      <td>ì´ë¯¸ì§€ ìŠ¬ë¼ì´ë”</td>
    </tr>
    <tr>
      <td>ë‚ ì§œ ì„ íƒ ë° ê°•ì•„ì§€ ìœ í˜• ì„ íƒ</td>
    </tr>
    <tr>
      <td>ì‹¤ì‹œê°„ ê°ì‹¤ ê°€ìš©ì„± ì²´í¬</td>
    </tr>
    <tr>
      <td>ì°œí•˜ê¸° ê¸°ëŠ¥</td>
    </tr>
    <tr>
      <td>ì¹´ì¹´ì˜¤ë§µ API ì—°ë™</td>
    </tr>
    <tr>
      <td rowspan="5">ì˜ˆì•½ í˜ì´ì§€</td>
      <td>ì˜ˆì•½ì ì •ë³´ ì…ë ¥ í¼</td>
    </tr>
    <tr>
      <td>ë°˜ë ¤ê²¬ ì •ë³´ ì…ë ¥ (ì´ë¦„, ì„±ë³„, ë‚˜ì´, ë¬´ê²Œ, ê²¬ì¢…)</td>
    </tr>
    <tr>
      <td>ì‹¤ì‹œê°„ ê°€ê²© ê³„ì‚°</td>
    </tr>
    <tr>
      <td>ìœ íš¨ì„± ê²€ì‚¬ (í”„ë¡ íŠ¸)</td>
    </tr>
    <tr>
      <td>ì˜ˆì•½ í™•ì¸ ì •ë³´ í‘œì‹œ</td>
    </tr>
    <tr>
      <td rowspan="4">ê²°ì œ ì‹œìŠ¤í…œ</td>
      <td>ì•„ì„í¬íŠ¸(Iamport) API ì—°ë™</td>
    </tr>
    <tr>
      <td>ì¹´ì¹´ì˜¤í˜ì´/í† ìŠ¤í˜ì´ ê²°ì œ ìˆ˜ë‹¨</td>
    </tr>
    <tr>
      <td>ê²°ì œ ì „ ë™ì˜ ì²´í¬</td>
    </tr>
    <tr>
      <td>CSRF í† í° ì²˜ë¦¬</td>
    </tr>
    <tr>
      <td rowspan="1">ê²°ì œ ì™„ë£Œ í˜ì´ì§€</td>
      <td>ì˜ˆì•½ ì™„ë£Œ ì•ˆë‚´</td>
    </tr>
  </tbody>
</table>

<br>

## ğŸ’¡ What I Learned

### ì•„í‚¤í…ì²˜ & ì½”ë“œ êµ¬ì¡°

- ì»¨íŠ¸ë¡¤ëŸ¬ì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í˜¼ì¬, JS í•¨ìˆ˜ íŒŒì¼í•˜ë‚˜ì— í†µìœ¼ë¡œ ê´€ë¦¬ â†’ í”„ë¡œì íŠ¸ ì´í›„ì— ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ìš¸ ê²ƒ ê°™ë‹¤ê³  ê¹¨ë‹«ê²Œ ë¨
- application.ymlì— API í‚¤, DB ë¹„ë°€ë²ˆí˜¸ ë“± ë¯¼ê°ì •ë³´ê°€ ë…¸ì¶œë¨ â†’ í™˜ê²½ë³€ìˆ˜Â·ì‹œí¬ë¦¿ ê´€ë¦¬ ì¤‘ìš”ì„± í•™ìŠµ

<br>

### ì™¸ë¶€ API ì—°ë™

- ì¹´ì¹´ì˜¤ë§µ API, ì•„ì„í¬íŠ¸ ê²°ì œ API ì—°ë™ ê²½í—˜ <br>
- API ë¬¸ì„œ ë¶„ì„, ì¸ì¦ í”Œë¡œìš° ì´í•´ì— ë§ì´ ë„ì›€ì´ ë˜ì—ˆë‹¤ 

<br>

### ì˜ˆì•½ ë° ê²°ì œ ë¡œì§ êµ¬í˜„

ReservationService
```
@Service
public class ReservationService {

    @Transactional
    public Reservation createReservation(ReservationRequest req) {
        // 1. í˜¸í…”/ê°ì‹¤ ìœ íš¨ì„± ì²´í¬
        Hotel hotel = hotelRepository.findById(req.getHotelId())
            .orElseThrow(() -> new NotFoundException("í˜¸í…” ì—†ìŒ"));

        // 2. ì˜ˆì•½ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
        if (!roomAvailabilityService.isAvailable(hotel, req.getDate())) {
            throw new IllegalStateException("ì˜ˆì•½ ë¶ˆê°€");
        }

        // 3. ì˜ˆì•½ ì •ë³´ ì €ì¥
        Reservation reservation = Reservation.of(req, hotel);
        reservationRepository.save(reservation);

        // 4. ê²°ì œ ë‹¨ê³„ë¡œ ì§„í–‰
        paymentService.processPayment(reservation);

        return reservation;
    }
}
```

<br>


ì•„ì„í¬íŠ¸ SDK í™œìš© â†’ ê²°ì œ ì„±ê³µ ì‹œ ì„œë²„ ê²€ì¦ ë° ì˜ˆì•½ ìƒíƒœ ì—…ë°ì´íŠ¸.

PaymentService
```
@Service
public class PaymentService {

    public void processPayment(Reservation reservation) {
        // 1. ê²°ì œ ìš”ì²­ ìƒì„±
        Payment payment = Payment.of(reservation);

        // 2. ì™¸ë¶€ PGì‚¬ API í˜¸ì¶œ (ex. KakaoPay, TossPayments)
        PaymentResult result = paymentGateway.request(payment);

        // 3. ê²°ê³¼ ì²˜ë¦¬
        if (result.isSuccess()) {
            reservation.markPaid();
        } else {
            throw new PaymentFailedException("ê²°ì œ ì‹¤íŒ¨");
        }
    }
}
```

<br>

### ê°œì„ í•  ì 

- ì˜ˆì•½-ê²°ì œ í”Œë¡œìš°ë¥¼ ìˆ˜ì •í•˜ëŠ”ê²Œ ì¢‹ì„ ê²ƒ ê°™ë‹¤
- ë‘˜ì„ ë³„ê°œì˜ ë¡œì§ìœ¼ë¡œ ë¶„ë¦¬í•˜ì§€ ì•Šê³ , íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ëŠ”ê²Œ ë” íš¨ìœ¨ì ì¸ë“¯

> 1. í˜¸í…” ìƒì„¸ â†’ ë‚ ì§œ/ê°•ì•„ì§€ ì„ íƒ (ê¸°ì¡´ê³¼ ë™ì¼)
> 2. ì˜ˆì•½ í˜ì´ì§€ â†’ ì •ë³´ ì…ë ¥ (ê¸°ì¡´ê³¼ ë™ì¼)
> 3. ê²°ì œ ë²„íŠ¼ í´ë¦­ ì‹œ:
>    - ì„œë²„ì— ì„ì‹œ ì˜ˆì•½ ìƒì„± (PENDING ìƒíƒœ, DB ì €ì¥ ì•ˆ í•¨ or PENDINGìœ¼ë¡œ ì €ì¥) -> ë©”ëª¨ë¦¬ì— ì €ì¥í•´ë„ ì¢‹ì„ ë“¯
>    - ê°€ìš©ì„± ì¬í™•ì¸
>    - 15ë¶„ ì •ë„ ì‹œê°„ì œí•œ
> 4. ì•„ì„í¬íŠ¸ ê²°ì œì°½ ë„ì›€
> 5. ê²°ì œ ì„±ê³µ ì‹œ:
>    @Transactional
>    - ì˜ˆì•½ ìƒì„± (PENDING)
>    - ê²°ì œ ê²€ì¦
>    - ì˜ˆì•½ ìƒíƒœ CONFIRMEDë¡œ ë³€ê²½
>    - ê°ì‹¤ ì¬ê³  ì°¨ê°
> 6. ê²°ì œ ì‹¤íŒ¨ ì‹œ:
>    - ì˜ˆì•½ ìƒì„± ì•ˆ í•¨
>    - ë˜ëŠ” PENDING ìƒíƒœì˜€ë‹¤ë©´ ì·¨ì†Œ
